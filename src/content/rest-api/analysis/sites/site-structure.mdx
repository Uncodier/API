---
title: Website Structural Analysis API
description: Comprehensive documentation for the advanced website structural analysis API
---

# Website Structural Analysis API

The `/api/site/analyze/structure` endpoint performs structural analysis of websites, evaluating heading hierarchy, content blocks, semantic structure, and relationships between elements.

## Key Features

- Advanced and flexible implementation
- Focused specifically on site structural analysis
- Uses specialized services for structure analysis
- Multiple advanced configuration options
- Supports multiple AI providers (OpenAI, Anthropic, Gemini)
- Sophisticated error handling system
- Option to save results to the database

import { UnifiedApiTester } from '@/components/ApiTester';

<UnifiedApiTester 
  apiType="site" 
  title="Website Structural Analyzer"
  description="Test the website structural analysis API with your own parameters."
  defaultEndpoint="/api/site/analyze/structure"
  defaultMethod="POST"
  defaultUrl="https://example.com"
  defaultTimeout="30000"
  showScreenshotOption={true}
  showModelOptions={true}
  defaultModelType="openai"
  defaultModel="gpt-5-nano"
  showAnalysisTypeField={false}
/>

## Structural Analysis Focus

Structural analysis focuses on understanding the organization and hierarchy of website content, including:

- Heading hierarchy
- Content blocks
- Semantic structure
- Relationships between elements
- Navigation and menus
- Main sections and their importance
- Design patterns used

## Available Methods

### POST /api/site/analyze/structure

Performs a structural analysis of the website, focused on DOM structure and content organization.

#### Request Parameters

```json
{
  "url": "https://example.com", // Site URL (required)
  "htmlContent": "<html>...</html>", // HTML de la página (opcional)
  "screenshot": "data:image/png;base64,...", // Captura de pantalla en Base64 (opcional)
  "site_id": "uuid-of-the-site", // ID del sitio para almacenamiento en BD (opcional)
  "user_id": "uuid-of-the-user", // ID del usuario para almacenamiento en BD (opcional)
  "options": {
    "timeout": 30000, // Max wait time in milliseconds (between 5000 and 60000)
    "userAgent": "Mozilla/5.0...", // Custom User Agent (optional)
    "depth": 2, // Analysis depth (1-3)
    "ignoreSSL": false, // Ignore SSL certificate errors
    "failOnError": false, // If false, continue even with errors
    "safeSelectors": true, // Validate selectors before use
    "includeScreenshot": true, // Include screenshot in response
    "provider": "openai", // AI provider: 'openai', 'anthropic', 'gemini'
    "modelId": "gpt-5-nano", // Specific AI model to use
    "saveToDatabase": false // Save results to database (requires site_id and user_id)
  }
}
```

#### Response

```json
{
  "url": "https://example.com",
  "structuredAnalysis": {
    // Detalles del análisis estructural...
  },
  "requestTime": 12345, // Processing time in milliseconds
  "timestamp": "2023-06-15T14:30:00Z",
  "analysis_id": "uuid-of-saved-analysis", // Present only if saveToDatabase=true and successful
  "database_status": "success", // "success", "error", or "not_saved"
  "database_error": null // Error message if database_status is "error"
}
```

#### Detailed Response

```json
{
  "url": "https://example.com",
  "structuredAnalysis": {
    "headings": {
      "h1": 1,
      "h2": 5,
      "h3": 12,
      "h4": 8
    },
    "sections": [
      {
        "type": "header",
        "elements": 5,
        "importance": "high"
      },
      {
        "type": "main-content",
        "elements": 25,
        "importance": "high"
      },
      {
        "type": "sidebar",
        "elements": 10,
        "importance": "medium"
      },
      {
        "type": "footer",
        "elements": 8,
        "importance": "low"
      }
    ],
    "navigation": {
      "mainMenu": {
        "items": 6,
        "depth": 2
      },
      "footer": {
        "items": 4,
        "depth": 1
      }
    },
    "contentBlocks": [
      {
        "type": "hero",
        "elements": 3,
        "position": "top"
      },
      {
        "type": "features",
        "elements": 12,
        "position": "middle"
      },
      {
        "type": "testimonials",
        "elements": 6,
        "position": "middle-bottom"
      },
      {
        "type": "contact",
        "elements": 5,
        "position": "bottom"
      }
    ],
    "semantics": {
      "articleCount": 3,
      "sectionCount": 8,
      "navCount": 2,
      "asideCount": 1,
      "footerCount": 1,
      "headerCount": 1
    },
    "accessibility": {
      "ariaUsage": {
        "score": 75,
        "details": "Moderate use of ARIA attributes"
      },
      "semanticStructure": {
        "score": 85,
        "details": "Good overall semantic structure"
      }
    }
  },
  "analysis": {
    "clarity": 85,
    "hierarchy": 90,
    "consistency": 80,
    "userExperience": 88,
    "navigationUsability": 82,
    "contentOrganization": 87
  },
  "patterns": [
    {
      "name": "Hero Section",
      "implementation": "Standard",
      "effectiveness": "High"
    },
    {
      "name": "Card Grid",
      "implementation": "Responsive",
      "effectiveness": "Medium-High"
    },
    {
      "name": "Sticky Navigation",
      "implementation": "Partial",
      "effectiveness": "Medium"
    }
  ],
  "recommendations": [
    {
      "category": "structure",
      "priority": "medium",
      "issue": "Inconsistent heading hierarchy",
      "recommendation": "Ensure headings follow a logical hierarchy",
      "impact": "Improves SEO and accessibility"
    },
    {
      "category": "navigation",
      "priority": "high",
      "issue": "Mobile menu is difficult to use",
      "recommendation": "Simplify the mobile menu structure",
      "impact": "Significant improvement in mobile experience"
    },
    {
      "category": "content",
      "priority": "low",
      "issue": "Misaligned content blocks",
      "recommendation": "Align content blocks to improve visual coherence",
      "impact": "Aesthetic and usability improvement"
    }
    // Otras recomendaciones...
  ],
  "timestamp": "2023-06-15T14:30:00Z",
  "analyzedBy": "AI Site Structure Analyzer v1.0",
  "analysisVersion": "1.0.0",
  "processingTime": 8765,
  "errors": [
    {
      "code": "SELECTOR_ERROR",
      "message": "No se pudo analizar un selector",
      "details": ".complex-selector > div:nth-child(3)",
      "recoverable": true
    }
    // Otros errores no críticos...
  ],
  "completeness": 95 // Porcentaje de completitud del análisis (0-100)
}
```

### GET /api/site/analyze/structure

Retrieves information about the structural analysis service.

#### Respuesta

```json
{
  "service": "AI Site Structure Analyzer",
  "version": "1.0.0",
  "status": "operational",
  "capabilities": [
    "structure-analysis",
    "semantic-analysis",
    "navigation-analysis",
    "content-organization",
    "pattern-detection"
  ],
  "limits": {
    "requestsPerDay": 100,
    "maxTimeout": 60000
  }
}
```

## Related Endpoints

### GET /api/site/analysis/:id

Retrieves a specific analysis by its ID (requires the analysis to have been stored in the database).

#### Respuesta

```json
{
  "success": true,
  "analysis": {
    "id": "uuid-of-analysis",
    "site_id": "uuid-of-site",
    "url_path": "/path/analyzed",
    "structure": { /* Datos de análisis estructural */ },
    "user_id": "uuid-of-user",
    "created_at": "2023-06-15T14:30:00Z",
    "updated_at": "2023-06-15T14:35:00Z",
    "status": "completed",
    "request_time": 12345,
    "provider": "openai",
    "model_id": "gpt-5-nano"
  }
}
```

### GET /api/site/analysis/site/:siteId

Retrieves all analyses for a specific site (requires the `user_id` query parameter).

#### Respuesta

```json
{
  "success": true,
  "analyses": [
    {
      "id": "uuid-of-analysis-1",
      "site_id": "uuid-of-site",
      "url_path": "/path/analyzed/1",
      "structure": { /* Datos de análisis estructural */ },
      "user_id": "uuid-of-user",
      "created_at": "2023-06-15T14:30:00Z",
      "updated_at": "2023-06-15T14:35:00Z",
      "status": "completed",
      "request_time": 12345,
      "provider": "openai",
      "model_id": "gpt-5-nano"
    },
    {
      "id": "uuid-of-analysis-2",
      "site_id": "uuid-of-site",
      "url_path": "/path/analyzed/2",
      // ... más propiedades
    }
  ]
}
```

## Differences with the General Analysis API

Esta API específica de análisis estructural (`/api/site/analyze/structure`) difiere de la API general (`/api/site/analyze`) en los siguientes aspectos:

1. **Enfoque**: Se centra exclusivamente en el análisis estructural del sitio, mientras que la API general abarca rendimiento, SEO, accesibilidad y mejores prácticas.
2. **Parámetros**: Incluye parámetros específicos para el análisis estructural, como la posibilidad de proporcionar HTML directamente.
3. **Respuesta**: Devuelve una estructura de respuesta enfocada en elementos estructurales como jerarquía, secciones, navegación y bloques de contenido.
4. **Análisis**: Proporciona un análisis más profundo de la estructura del sitio, incluyendo patrones de diseño y organización del contenido.
5. **Almacenamiento**: Permite guardar los resultados del análisis en la base de datos para su consulta posterior.

> Note: If you need a broader analysis including performance, SEO, and more, use the general API `/api/site/analyze`. See the [General Site Analysis API documentation](/api/analysis/sites/site).

## Status Codes

- `200 OK`: Request completed successfully
- `400 Bad Request`: Invalid request parameters
- `404 Not Found`: Resource not found
- `429 Too Many Requests`: Rate limit exceeded
- `500 Internal Server Error`: Server error during analysis
- `504 Gateway Timeout`: Analysis timed out

## Usage Examples

### Perform a basic structural analysis

```javascript
const response = await fetch('https://yourdomain.com/api/site/analyze/structure', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    url: 'https://example.com',
    options: {
      depth: 2,
      timeout: 30000,
      includeScreenshot: true
    }
  })
});

const data = await response.json();
console.log(data.structuredAnalysis); // Site structure
```

### Perform a structural analysis with provided HTML and save results

```javascript
const response = await fetch('https://yourdomain.com/api/site/analyze/structure', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    url: 'https://example.com',
    htmlContent: '<html>...</html>', // Site HTML
    site_id: 'site-uuid', // Site ID in your DB
    user_id: 'user-uuid', // User ID in your DB
    options: {
      depth: 3,
      provider: 'anthropic',
      modelId: 'claude-3-5-sonnet-20240620',
      saveToDatabase: true // Save analysis in DB
    }
  })
});

const data = await response.json();
console.log(data.analysis_id); // Saved analysis ID
console.log(data.structuredAnalysis); // Analysis data
```

### Get a saved analysis by ID

```javascript
const analysisId = 'analysis-uuid';
const response = await fetch(`https://yourdomain.com/api/site/analysis/${analysisId}`, {
  method: 'GET'
});

const data = await response.json();
console.log(data.analysis); // Retrieved analysis
```

### Get all analyses for a site

```javascript
const siteId = 'site-uuid';
const userId = 'user-uuid';
const response = await fetch(`https://yourdomain.com/api/site/analysis/site/${siteId}?user_id=${userId}`, {
  method: 'GET'
});

const data = await response.json();
console.log(data.analyses); // List of analyses
```

## Database Storage

To use database persistence, this API leverages the existing `analysis` table in your Supabase database.

### Prerequisites

1. Supabase project with the `analysis` table configured
2. `analysis` table with the required fields (see documentation)

### Setup

No new table is needed. This API uses the existing `analysis` table. Ensure it contains the required fields:

- `id` (UUID, clave primaria)
- `site_id` (UUID)
- `url_path` (TEXT)
- `structure` (JSONB)
- `user_id` (UUID)
- `created_at` (TIMESTAMPTZ)
- `updated_at` (TIMESTAMPTZ)
- `status` (TEXT)
- `request_time` (INTEGER)
- `provider` (TEXT)
- `model_id` (TEXT)

For configuration and troubleshooting details, see `docs/setup-site-analysis-database.md`.

### Possible Errors

If you encounter an error saving to the database, the `database_error` field in the response will contain details:

```json
{
  "url": "https://example.com",
  "structuredAnalysis": { /* analysis data */ },
  "database_status": "error",
  "database_error": "The analysis table does not exist. Please contact the administrator."
}
```

Common issues include:
- Missing table: Verify that the `analysis` table exists
- Insufficient permissions: Check RLS policies and permissions
- Invalid values: Ensure provided UUIDs are valid