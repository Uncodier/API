# API de Experimentos

Esta sección proporciona documentación detallada sobre el sistema de experimentación y testing A/B integrado en nuestro script de tracking. Esta funcionalidad permite modificar dinámicamente la experiencia de usuario en el sitio web basándose en segmentos de usuarios y objetivos de experimentos.

## Descripción general

El sistema de experimentos permite realizar cambios en la interfaz de usuario, contenido y funcionalidad de un sitio web sin necesidad de desplegar nuevas versiones. El script de tracking puede inyectar código, modificar elementos existentes o cambiar el comportamiento de la página basándose en reglas predefinidas.

### Características principales

- Testing A/B y multivariante
- Segmentación avanzada de audiencias
- Personalización basada en comportamiento
- Análisis de resultados en tiempo real
- Inyección de código sin impacto en rendimiento
- Despliegue gradual (rollout) de cambios

## Integración básica

El sistema de experimentos utiliza el mismo script de tracking que el módulo de visitantes:

```html
<script async src="https://cdn.site-analyzer.com/tracker.js" id="site-analyzer-script" data-site-id="TU_SITE_ID"></script>
```

No se requiere configuración adicional para habilitar los experimentos, ya que se activan automáticamente cuando se definen en el panel de control.

## Funcionamiento

1. Un usuario visita tu sitio web
2. El script de tracking solicita los experimentos activos al servidor
3. Basándose en las reglas de segmentación, se determina qué experimentos aplican al visitante
4. Se ejecutan las modificaciones definidas en los experimentos aplicables
5. Se registran las impresiones, interacciones y conversiones relacionadas con el experimento

## Endpoints disponibles

- [/api/experiments/list](/api/experiments/list) - Obtener experimentos activos para un sitio
- [/api/experiments/expose](/api/experiments/expose) - Registrar la exposición de un usuario a un experimento
- [/api/experiments/convert](/api/experiments/convert) - Registrar una conversión para un experimento
- [/api/experiments/query](/api/experiments/query) - Consultar datos sobre el rendimiento de los experimentos

## Tipos de experimentos

### Test A/B clásico
Compara dos o más variantes de una página o componente para determinar cuál genera mejores resultados.

### Test multivariante
Prueba múltiples combinaciones de cambios simultáneamente para identificar la mejor combinación.

### Rollout gradual
Implementa cambios para un porcentaje creciente de usuarios antes de aplicarlos globalmente.

### Personalización
Muestra contenido diferente basado en el comportamiento o características del usuario.

## Consideraciones de rendimiento

El sistema está diseñado para minimizar el impacto en el rendimiento del sitio:

- La carga de experimentos se realiza de forma asíncrona
- Se utiliza caché local para evitar solicitudes innecesarias
- Los experimentos se aplican lo antes posible para minimizar parpadeos (FOOC)
- El código inyectado se optimiza automáticamente

## Consideraciones de privacidad

Los experimentos cumplen con las regulaciones GDPR, CCPA y ePrivacy. Todos los cambios dinámicos realizados se consideran parte integral del sitio web y están cubiertos por la misma política de privacidad.

## Limitaciones

- **Máximo de experimentos activos**: 20 por sitio
- **Máximo de variantes**: 10 por experimento
- **Tamaño máximo de código inyectado**: 100KB por experimento
- **Tiempo mínimo entre evaluaciones**: 1 hora (para cambios en la configuración de experimentos) 